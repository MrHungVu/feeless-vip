!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@binance/w3w-utils")):"function"==typeof define&&define.amd?define(["@binance/w3w-utils"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["@tronweb3/tronwallet-adapter-binance"]=t(e.require$$0)}(this,(function(e){"use strict";function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n,r,o={},i={},s={},a={},c={exports:{}};function l(){if(r)return a;r=1;var e=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0}),a.Adapter=a.AdapterState=a.WalletReadyState=a.EventEmitter=void 0;const t=e((n||(n=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,s=new Array(i);o<i;o++)s[o]=r[o].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,d=this._events[a],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,o),!0;case 5:return d.fn.call(d.context,t,r,o,i),!0;case 6:return d.fn.call(d.context,t,r,o,i,s),!0}for(l=1,c=new Array(u-1);l<u;l++)c[l-1]=arguments[l];d.fn.apply(d.context,c)}else{var h,f=d.length;for(l=0;l<f;l++)switch(d[l].once&&this.removeListener(e,d[l].fn,void 0,!0),u){case 1:d[l].fn.call(d[l].context);break;case 2:d[l].fn.call(d[l].context,t);break;case 3:d[l].fn.call(d[l].context,t,r);break;case 4:d[l].fn.call(d[l].context,t,r,o);break;default:if(!c)for(h=1,c=new Array(u-1);h<u;h++)c[h-1]=arguments[h];d[l].fn.apply(d[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var c=0,l=[],d=a.length;c<d;c++)(a[c].fn!==t||o&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[i]=1===l.length?l[0]:l:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(c)),c.exports));var o,i;a.EventEmitter=t.default,function(e){e.Loading="Loading",e.NotFound="NotFound",e.Found="Found"}(o||(a.WalletReadyState=o={})),function(e){e.Loading="Loading",e.NotFound="NotFound",e.Disconnect="Disconnected",e.Connected="Connected"}(i||(a.AdapterState=i={}));class s extends t.default{get connected(){return this.state===i.Connected}disconnect(){return console.info("The current adapter doesn't support disconnect by DApp."),Promise.resolve()}multiSign(...e){return Promise.reject("The current wallet doesn't support multiSign.")}switchChain(e){return Promise.reject("The current wallet doesn't support switch chain.")}}return a.Adapter=s,a}var d,u={};function h(){if(d)return u;d=1,Object.defineProperty(u,"__esModule",{value:!0}),u.WalletGetNetworkError=u.WalletSwitchChainError=u.WalletWindowClosedError=u.WalletWalletLoadError=u.WalletSignTransactionError=u.WalletSignMessageError=u.WalletDisconnectionError=u.WalletConnectionError=u.WalletDisconnectedError=u.WalletNotSelectedError=u.WalletNotFoundError=u.WalletError=void 0;class e extends Error{constructor(e,t){super(e),this.error=t}}u.WalletError=e;u.WalletNotFoundError=class extends e{constructor(){super(...arguments),this.name="WalletNotFoundError",this.message="The wallet is not found."}};u.WalletNotSelectedError=class extends e{constructor(){super(...arguments),this.name="WalletNotSelectedError",this.message="No wallet is selected. Please select a wallet."}};u.WalletDisconnectedError=class extends e{constructor(){super(...arguments),this.name="WalletDisconnectedError",this.message="The wallet is disconnected. Please connect first."}};u.WalletConnectionError=class extends e{constructor(){super(...arguments),this.name="WalletConnectionError"}};u.WalletDisconnectionError=class extends e{constructor(){super(...arguments),this.name="WalletDisconnectionError"}};u.WalletSignMessageError=class extends e{constructor(){super(...arguments),this.name="WalletSignMessageError"}};u.WalletSignTransactionError=class extends e{constructor(){super(...arguments),this.name="WalletSignTransactionError"}};u.WalletWalletLoadError=class extends e{constructor(){super(...arguments),this.name="WalletWalletLoadError"}};u.WalletWindowClosedError=class extends e{constructor(){super(...arguments),this.name="WalletWindowClosedError",this.message="The QR window is closed."}};u.WalletSwitchChainError=class extends e{constructor(){super(...arguments),this.name="WalletSwitchChainError"}};return u.WalletGetNetworkError=class extends e{constructor(){super(...arguments),this.name="WalletGetNetworkError"}},u}var f,p={};function w(){return f||(f=1,Object.defineProperty(p,"__esModule",{value:!0}),p.ChainNetwork=p.NetworkType=void 0,function(e){e.Mainnet="Mainnet",e.Shasta="Shasta",e.Nile="Nile",e.Unknown="Unknown"}(e||(p.NetworkType=e={})),function(e){e.Mainnet="Mainnet",e.Shasta="Shasta",e.Nile="Nile"}(t||(p.ChainNetwork=t={}))),p;var e,t}var v,y,g,_={};function M(){if(v)return _;function e(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator}return v=1,Object.defineProperty(_,"__esModule",{value:!0}),_.isInBrowser=e,_.checkAdapterState=function(t){if(!e())return;const n=[];function r(){for(const e of n)e()}function o(){t()&&r()}const i=setInterval(o,500);n.push((()=>clearInterval(i))),"loading"===document.readyState&&(document.addEventListener("DOMContentLoaded",o,{once:!0}),n.push((()=>document.removeEventListener("DOMContentLoaded",o))));"complete"!==document.readyState&&(window.addEventListener("load",o,{once:!0}),n.push((()=>window.removeEventListener("load",o))));o(),setTimeout(r,6e4)},_.isInMobileBrowser=function(){return"undefined"!=typeof navigator&&navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i)},_}function m(){return y||(y=1,function(e){var t=s&&s.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=s&&s.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(l(),e),n(h(),e),n(w(),e),n(M(),e)}(s)),s}function E(){return g||(g=1,function(e){var t=i&&i.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BinanceWalletAdapter=e.BinanceWalletAdapterName=void 0;const n=m();e.BinanceWalletAdapterName="Binance Wallet";const r={"0x2b6653dc":n.NetworkType.Mainnet,"0x94a9059e":n.NetworkType.Shasta,"0xcd8690dc":n.NetworkType.Nile};class o extends n.Adapter{constructor(t={}){super(),this.name=e.BinanceWalletAdapterName,this.url="https://www.binance.com/en/binancewallet",this.icon="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAiIGhlaWdodD0iMzAiIHZpZXdCb3g9IjAgMCAzMCAzMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMwIiBoZWlnaHQ9IjMwIiBmaWxsPSIjMEIwRTExIi8+CjxwYXRoIGQ9Ik01IDE1TDcuMjU4MDYgMTIuNzQxOUw5LjUxNjEzIDE1TDcuMjU4MDYgMTcuMjU4MUw1IDE1WiIgZmlsbD0iI0YwQjkwQiIvPgo8cGF0aCBkPSJNOC44NzA5NyAxMS4xMjlMMTUgNUwyMS4xMjkgMTEuMTI5TDE4Ljg3MSAxMy4zODcxTDE1IDkuNTE2MTNMMTEuMTI5IDEzLjM4NzFMOC44NzA5NyAxMS4xMjlaIiBmaWxsPSIjRjBCOTBCIi8+CjxwYXRoIGQ9Ik0xMi43NDE5IDE1TDE1IDEyLjc0MTlMMTcuMjU4MSAxNUwxNSAxNy4yNTgxTDEyLjc0MTkgMTVaIiBmaWxsPSIjRjBCOTBCIi8+CjxwYXRoIGQ9Ik0xMS4xMjkgMTYuNjEyOUw4Ljg3MDk3IDE4Ljg3MUwxNSAyNUwyMS4xMjkgMTguODcxTDE4Ljg3MSAxNi42MTI5TDE1IDIwLjQ4MzlMMTEuMTI5IDE2LjYxMjlaIiBmaWxsPSIjRjBCOTBCIi8+CjxwYXRoIGQ9Ik0yMC40ODM5IDE1TDIyLjc0MTkgMTIuNzQxOUwyNSAxNUwyMi43NDE5IDE3LjI1ODFMMjAuNDgzOSAxNVoiIGZpbGw9IiNGMEI5MEIiLz4KPC9zdmc+Cg==",this._readyState=(0,n.isInBrowser)()?n.WalletReadyState.Loading:n.WalletReadyState.NotFound,this._state=n.AdapterState.Loading,this._onAccountsChanged=e=>{const t=this.address||"";this.setAddress(e[0]),this.emit("accountsChanged",this.address||"",t)},this._checkPromise=null,this._updateProvider=()=>{var e;let t=this.state,r=this.address;(null===(e=window.binancew3w)||void 0===e?void 0:e.tron)?(this._provider=window.binancew3w.tron,r=null,t=n.AdapterState.Disconnect):(this._provider=null,r=null,t=n.AdapterState.NotFound),this.setAddress(r),this.setState(t)};const{checkTimeout:r=2e3,openUrlWhenWalletNotFound:o=!0}=t;if("number"!=typeof r)throw new Error("[BinanceWalletAdapter] config.checkTimeout should be a number");if(this.config={checkTimeout:r,openUrlWhenWalletNotFound:o},this._connecting=!1,this._provider=null,this._address=null,!(0,n.isInBrowser)())return this._readyState=n.WalletReadyState.NotFound,void this.setState(n.AdapterState.NotFound);this._checkWallet().then((()=>{this.connected&&(this.emit("connect",this.address||""),this._listenEvent())}))}get address(){return this._address}get state(){return this._state}get readyState(){return this._readyState}get connecting(){return this._connecting}network(){return t(this,void 0,void 0,(function*(){try{if(yield this._checkWallet(),this.state!==n.AdapterState.Connected)throw new n.WalletDisconnectedError;try{const e=this._provider.getChainId();return{networkType:r[e]||n.NetworkType.Unknown,chainId:e,fullNode:"",solidityNode:"",eventServer:""}}catch(e){throw new n.WalletGetNetworkError(null==e?void 0:e.message,e)}}catch(e){throw this.emit("error",e),e}}))}connect(){return t(this,void 0,void 0,(function*(){try{if(this.connected||this.connecting)return;if(yield this._checkWallet(),this.state===n.AdapterState.NotFound)throw!1!==this.config.openUrlWhenWalletNotFound&&(0,n.isInBrowser)()&&window.open(this.url,"_blank"),new n.WalletNotFoundError;this._connecting=!0;try{const{address:e}=yield this._provider.getAccount();this.setAddress(e),this.setState(n.AdapterState.Connected),this.emit("connect",e),this._listenEvent()}catch(e){throw new n.WalletConnectionError(null==e?void 0:e.message,e)}}catch(e){throw this.emit("error",e),e}finally{this._connecting=!1}}))}disconnect(){return t(this,void 0,void 0,(function*(){this.state===n.AdapterState.Connected&&(yield this._provider.disconnect(),this.setAddress(null),this.setState(n.AdapterState.Disconnect),this.emit("disconnect"),this._stopListenEvent())}))}signMessage(e){return t(this,void 0,void 0,(function*(){try{if(this.state!==n.AdapterState.Connected)throw new n.WalletDisconnectedError;try{return yield this._provider.signMessageV2(e)}catch(e){throw new n.WalletSignMessageError(null==e?void 0:e.message,e)}}catch(e){throw this.emit("error",e),e}}))}signTransaction(e){return t(this,void 0,void 0,(function*(){try{if(this.state!==n.AdapterState.Connected)throw new n.WalletDisconnectedError;try{return yield this._provider.signTransaction(e)}catch(e){throw new n.WalletSignTransactionError(null==e?void 0:e.message,e)}}catch(e){throw this.emit("error",e),e}}))}_listenEvent(){this._stopListenEvent(),this._provider.on("accountsChanged",this._onAccountsChanged)}_stopListenEvent(){this._provider.removeListener("accountsChanged",this._onAccountsChanged)}_checkWallet(){return t(this,void 0,void 0,(function*(){if(this.readyState===n.WalletReadyState.Found)return!0;if(this._checkPromise)return this._checkPromise;const e=Math.floor(this.config.checkTimeout/100);let t,r=0;return this._checkPromise=new Promise((o=>{const i=()=>{var i;r++;const s=!!(null===(i=window.binancew3w)||void 0===i?void 0:i.tron);(s||r>e)&&(t&&clearInterval(t),this._readyState=s?n.WalletReadyState.Found:n.WalletReadyState.NotFound,this._updateProvider(),this.emit("readyStateChanged",this.readyState),o(s))};t=setInterval(i,100),i()})),this._checkPromise}))}setAddress(e){this._address=e}setState(e){e!==this.state&&(this._state=e,this.emit("stateChanged",e))}}e.BinanceWalletAdapter=o}(i)),i}var W,S,x={};function I(){if(W)return x;W=1,Object.defineProperty(x,"__esModule",{value:!0}),x.supportBinanceWallet=r,x.openBinanceWallet=function(){if((0,n.isInMobileBrowser)()&&!r())return window.location.href=(0,t.getDeepLink)(window.location.href).bnc,!0;return!1};const t=e,n=m();function r(){return(0,n.isInBrowser)()&&Boolean(window.isBinance)}return x}return t((S||(S=1,function(e){var t=o&&o.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=o&&o.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(E(),e),n(I(),e)}(o)),o))}));
